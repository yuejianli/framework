# 水平分库
server:
  port: 8081
  servlet:
    context-path: /Sharding
# 引入 数据库的相关配置
spring:
  main:
    # 配置，一个实体类对应多张表，覆盖
    allow-bean-definition-overriding: true
  shardingsphere:
    datasource:
      # 指定数据源名称
      names: s1,s2
      s1:
        driver-class-name: com.mysql.cj.jdbc.Driver
        url: jdbc:mysql://localhost:3306/springboot_1?serverTimezone=GMT%2B8&useUnicode=true&characterEncoding=UTF-8&useSSL=false&allowMultiQueries=true
        username: root
        password: abc123
        type: com.alibaba.druid.pool.DruidDataSource
      s2:
        driver-class-name: com.mysql.cj.jdbc.Driver
        url: jdbc:mysql://localhost:3306/springboot_2?serverTimezone=GMT%2B8&useUnicode=true&characterEncoding=UTF-8&useSSL=false&allowMultiQueries=true
        username: root
        password: abc123
        type: com.alibaba.druid.pool.DruidDataSource
    # 配置规则
    sharding:
      tables:
        user:
          # 指定user 表的分布情况，配置在哪个数据库下的哪个表里面
          actual-data-nodes: s$->{1..2}.user_$->{0..1}
          # 配置key 的生成策略
          key-generator:
            column: id
            type: SNOWFLAKE
          # 指定表的分片策略
          table-strategy:
            inline:
              sharding-column: id
              # 根据 id 进行处理 %2 为偶数放置在 user_0,  奇数放置在  user_1
              algorithm-expression: user_$->{id%2}
          # 指定库的分片策略
          database-strategy:
            inline:
              sharding-column: schoolId
              # 使用 schoolId 进行配置。 为偶数放置在 s1 库里面，为 奇数放置在 s2 库里面。与表相反。
              algorithm-expression: s$->{schoolId %2 +1}
    # 配置 sql 语句输出
    props:
      sql:
        show: true
#整合mybatis时使用的
mybatis-plus:
  # 配置 mapper文件的位置
  mapper-locations: classpath:mybatis/mapper/**/*.xml
  # 配置日志
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    map-underscore-to-camel-case: true #  配置别名设置
  global-config:
    db-config:
      logic-delete-field: flag   # 逻辑删除的字段
      logic-not-delete-value: 1  # 正常状态下，该字段的值
      logic-delete-value: 0      # 删除后，该字段的值
      table-underline: true # 驼峰方式转换
#分页插件
pagehelper:
  helperDialect: mysql
  reasonable: true
  supportMethodsArguments: true
  params: count=countSql
